{{ 'component-product.css' | asset_url | stylesheet_tag }}
<script src="{{ 'product-form.js' | asset_url }}" defer="defer"></script>

{% assign current_variant = product.selected_or_first_available_variant %}

<section class="product" data-section-id="{{ section.id }}" data-product-id="{{ product.id }}">
  <div class="product__wrapper page-width">
    <div class="product__media-wrapper">
      <div class="product__media-list">
        {% for media in product.media %}
          <div class="product__media-item" data-media-id="{{ media.id }}">
            {% case media.media_type %}
              {% when 'image' %}
                <img
                  src="{{ media | image_url: width: 800 }}"
                  srcset="
                    {{ media | image_url: width: 400 }} 400w,
                    {{ media | image_url: width: 600 }} 600w,
                    {{ media | image_url: width: 800 }} 800w,
                    {{ media | image_url: width: 1200 }} 1200w
                  "
                  sizes="(min-width: 990px) 50vw, 100vw"
                  alt="{{ media.alt | escape }}"
                  loading="lazy"
                  width="{{ media.width }}"
                  height="{{ media.height }}"
                >
              {% when 'video' %}
                {{ media | media_tag: image_size: "800x", autoplay: true, loop: true, muted: true }}
              {% when 'external_video' %}
                {{ media | media_tag: image_size: "800x" }}
              {% when 'model' %}
                {{ media | media_tag: image_size: "800x" }}
            {% endcase %}
          </div>
        {% endfor %}
      </div>
    </div>

    <div class="product__info-wrapper">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'vendor' %}
            {% if product.vendor != blank %}
              <p class="product__vendor" {{ block.shopify_attributes }}>{{ product.vendor }}</p>
            {% endif %}

          {% when 'title' %}
            <h1 class="product__title" {{ block.shopify_attributes }}>{{ product.title | escape }}</h1>

          {% when 'price' %}
            <div class="product__price" {{ block.shopify_attributes }}>
              {% render 'price', product: product, use_variant: true, show_badges: true %}
            </div>

          {% when 'description' %}
            {% if product.description != blank %}
              <div class="product__description rte" {{ block.shopify_attributes }}>
                {{ product.description }}
              </div>
            {% endif %}

          {% when 'variant_picker' %}
            <div class="product__variants" {{ block.shopify_attributes }}>
              {% render 'variant-picker', product: product, block: block %}
            </div>

          {% when 'quantity_selector' %}
            <div class="product__quantity" {{ block.shopify_attributes }}>
              <label for="Quantity-{{ section.id }}" class="product__quantity-label">
                {{ 'products.product.quantity.label' | t }}
              </label>
              <div class="quantity-selector">
                <button type="button" class="quantity-selector__button" data-quantity-button="decrease" aria-label="{{ 'products.product.quantity.decrease' | t }}">
                  {% render 'icon-minus' %}
                </button>
                <input
                  type="number"
                  class="quantity-selector__input"
                  id="Quantity-{{ section.id }}"
                  name="quantity"
                  value="1"
                  min="1"
                  aria-label="{{ 'products.product.quantity.input_label' | t }}"
                >
                <button type="button" class="quantity-selector__button" data-quantity-button="increase" aria-label="{{ 'products.product.quantity.increase' | t }}">
                  {% render 'icon-plus' %}
                </button>
              </div>
            </div>

          {% when 'buy_buttons' %}
            <div class="product__buy-buttons" {{ block.shopify_attributes }}>
              {% form 'product', product, class: 'product-form' %}
                <input type="hidden" name="id" value="{{ current_variant.id }}">
                
                <button
                  type="submit"
                  name="add"
                  class="product-form__submit button button--primary"
                  {% unless current_variant.available %}disabled{% endunless %}
                  data-add-to-cart
                >
                  <span data-add-to-cart-text>
                    {% if current_variant.available %}
                      {{ 'products.product.add_to_cart' | t }}
                    {% else %}
                      {{ 'products.product.sold_out' | t }}
                    {% endif %}
                  </span>
                </button>

                {% if block.settings.show_dynamic_checkout %}
                  {{ form | payment_button }}
                {% endif %}
              {% endform %}
            </div>

          {% when 'share' %}
            <div class="product__share" {{ block.shopify_attributes }}>
              {% render 'share-button', share_title: product.title, share_url: product.url %}
            </div>
        {% endcase %}
      {% endfor %}
    </div>
  </div>
</section>

<script type="application/ld+json">
{
  "@context": "http://schema.org/",
  "@type": "Product",
  "name": {{ product.title | json }},
  "url": {{ request.origin | append: product.url | json }},
  {% if product.featured_media %}
    "image": [
      {{ product.featured_media | image_url: width: 1200 | prepend: "https:" | json }}
    ],
  {% endif %}
  "description": {{ product.description | strip_html | json }},
  {% if product.selected_or_first_available_variant.sku != blank %}
    "sku": {{ product.selected_or_first_available_variant.sku | json }},
  {% endif %}
  "brand": {
    "@type": "Brand",
    "name": {{ product.vendor | json }}
  },
  "offers": [
    {% for variant in product.variants %}
      {
        "@type": "Offer",
        "availability": "{% if variant.available %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}",
        "price": {{ variant.price | divided_by: 100.0 | json }},
        "priceCurrency": {{ cart.currency.iso_code | json }},
        "url": {{ request.origin | append: variant.url | json }}
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]
}
</script>

{% schema %}
{
  "name": "Product information",
  "tag": "section",
  "blocks": [
    {
      "type": "vendor",
      "name": "Vendor",
      "limit": 1
    },
    {
      "type": "title",
      "name": "Title",
      "limit": 1
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1
    },
    {
      "type": "variant_picker",
      "name": "Variant picker",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "picker_type",
          "label": "Type",
          "options": [
            {
              "value": "dropdown",
              "label": "Dropdown"
            },
            {
              "value": "button",
              "label": "Button"
            }
          ],
          "default": "button"
        }
      ]
    },
    {
      "type": "quantity_selector",
      "name": "Quantity selector",
      "limit": 1
    },
    {
      "type": "buy_buttons",
      "name": "Buy buttons",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_dynamic_checkout",
          "default": true,
          "label": "Show dynamic checkout buttons"
        }
      ]
    },
    {
      "type": "share",
      "name": "Share",
      "limit": 1
    }
  ]
}
{% endschema %}
